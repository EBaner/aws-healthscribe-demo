version: 1
applications:
  - frontend:
      phases:
        preBuild:
          commands:
            - npm install
        build:
          commands:
            - npm run build
            - |
              echo '{
                "version": "1.0",
                "artifacts": {
                  "baseDirectory": "build",
                  "files": [
                    "**/*"
                  ]
                },
                "environment": {
                  "variables": {
                    "AMPLIFY_MONOREPO_APP_ROOT": "/"
                  }
                }
              }' > build/deploy-manifest.json
            - ls -la build
            - cat build/deploy-manifest.json
      artifacts:
        baseDirectory: build
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
